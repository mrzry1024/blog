(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{628:function(s,a,e){"use strict";e.r(a);var t=e(10),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"easy-forensic"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#easy-forensic"}},[s._v("#")]),s._v(" easy_Forensic")]),s._v(" "),e("p",[s._v("小明不小心把自己出题的flag在微信中发了出去，你能找到这个flag吗？")]),s._v(" "),e("br"),s._v(" "),e("h3",{attrs:{id:"writeup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#writeup"}},[s._v("#")]),s._v(" writeup")]),s._v(" "),e("p",[s._v("用DiskGenius打开内存镜像，在Admin的桌面发现几个文件")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://mrzry.oss-cn-guangzhou.aliyuncs.com/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022-Misc-easy_Forensic/image-20220817230734293.png",alt:""}})]),s._v(" "),e("p",[s._v("其中，"),e("code",[s._v("hint.txt")]),s._v("为")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("is _\nnot \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("使用volatility查看镜像信息")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("volatility.exe -f ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("secret.raw imageinfo\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Volatility Foundation Volatility Framework 2.6\nINFO    : volatility.debug    : Determining profile based on KDBG search...\n          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418\n                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)\n                     AS Layer2 : FileAddressSpace (E:\\桌面\\secret.raw)\n                      PAE type : No PAE\n                           DTB : 0x187000L\n                          KDBG : 0xf80003fef070L\n          Number of Processors : 1\n     Image Type (Service Pack) : 0\n                KPCR for CPU 0 : 0xfffff80003ff0d00L\n             KUSER_SHARED_DATA : 0xfffff78000000000L\n           Image date and time : 2022-08-13 11:48:11 UTC+0000\n     Image local date and time : 2022-08-13 19:48:11 +0800\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])]),e("p",[s._v("扫描内存文件")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("volatility.exe -f ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("secret.raw --profile"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Win7SP1x64 filescan "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" filescan.txt\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("导出内存文件")]),s._v(" "),e("ul",[e("li",[s._v("gift.jpg")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("volatility.exe -f ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("secret.raw --profile"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Win7SP1x64 dumpfiles -Q 0x000000007d80a7d0 --dump-dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("secret.zip")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("volatility.exe -f ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("secret.raw --profile"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Win7SP1x64 dumpfiles -Q 0x000000007d84e350 --dump-dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("wechat.txt")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("volatility.exe -f ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("secret.raw --profile"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Win7SP1x64 dumpfiles -Q 0x000000007dae0420 --dump-dir"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("打开图片可以看到图片底部有黑点，应该还有字，用010editor打开，修改图片高度")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://mrzry.oss-cn-guangzhou.aliyuncs.com/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022-Misc-easy_Forensic/image-20220817231448244.png",alt:""}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://mrzry.oss-cn-guangzhou.aliyuncs.com/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022-Misc-easy_Forensic/image-20220817231539309.png",alt:""}})]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Nothing is more important than your life!\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("作为密码解压"),e("code",[s._v("secret.zip")]),s._v("，而"),e("code",[s._v("hint.txt")]),s._v("的大概意思就是用"),e("code",[s._v("_")]),s._v("代替空格，替换后得到")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("Nothing_is_more_important_than_your_life!\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("解压得到"),e("code",[s._v("gift.txt")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("A gift for You:  wHeMscYvTluyRvjf5d7AEX5K4VlZeU2IiGpKLFzek1Q=\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("至此大致可以知道，"),e("code",[s._v("wechat.txt")]),s._v("为微信聊天记录的加密数据库，"),e("code",[s._v("gift.txt")]),s._v("为密码")]),s._v(" "),e("p",[s._v("使用GitHub上的脚本进行解密："),e("a",{attrs:{href:"https://github.com/x1hy9/WeChatUserDB",target:"_blank",rel:"noopener noreferrer"}},[s._v("x1hy9/WeChatUserDB: GetWeChat DBPassword&&UserInfo(获取PC数据库密码以及相关微信用户信息支持多系统数据库解密) (github.com)"),e("OutboundLink")],1)]),s._v(" "),e("p",[s._v("将"),e("code",[s._v("wechat.txt")]),s._v("重命名为"),e("code",[s._v("wechat.db")]),s._v("，然后放到"),e("code",[s._v("WIN_WECHAT_DB")]),s._v("文件夹中，运行python脚本")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("python ."),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("main.py -d windows -k "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("wHeMscYvTluyRvjf5d7AEX5K4VlZeU2IiGpKLFzek1Q")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://mrzry.oss-cn-guangzhou.aliyuncs.com/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022-Misc-easy_Forensic/image-20220817232142818.png",alt:""}})]),s._v(" "),e("p",[s._v("可以看到解密成功，在"),e("code",[s._v("DECRYPT_WIN_WECHAT_DB")]),s._v("中可以得到"),e("code",[s._v("decrypt_wechat.db")])]),s._v(" "),e("p",[s._v("使用SQLiteStudio打开db文件，在Session表中看到flag")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://mrzry.oss-cn-guangzhou.aliyuncs.com/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22022-Misc-easy_Forensic/image-20220817232414249.png",alt:""}})]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("flag{The_Is_Y0ur_prize}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);